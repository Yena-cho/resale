<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.finger.shinhandamoa.data.domain.mapper.NoticeMasterMapper">
    <select id="aggregate" resultType="kr.co.finger.shinhandamoa.data.domain.model.Statistics">
        SELECT COUNT(DISTINCT A.NOTIMASCD) AS "COUNT",
        COALESCE(SUM(COALESCE(B.PAYITEMAMT, 0)), 0) AS "AMOUNT"
        FROM XNOTIMAS A
            INNER JOIN XNOTIDET B ON B.NOTIMASCD=A.NOTIMASCD
        WHERE A.CHACD=#{chaCd}
        <if test="cancelYn != null">
            AND A.NOTI_CAN_YN=#{cancelYn}
        </if>
          AND A.MASDAY BETWEEN #{fromDate} AND #{toDate}
          AND A.NOTIMASST IN <foreach collection="stateList" item="each" open="(" close=")" separator=", ">#{each}</foreach>
    </select>
    
</mapper>
